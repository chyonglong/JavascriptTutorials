<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,minimal-ui:ios">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="">
    <script>


        console.log("共同翻译一本书 ==> 宏观任务开始")

        console.log("我分析工作量找到有6章")

        var finishStatus = [0, 0, 0, 0, 0, 0]
        // a 翻译第1章

        console.log("第1章：A 翻译")
        setTimeout(function () {
            console.log('A 翻译第1章 完成 ==> 宏观任务开始')
            finishStatus[0] = 1
            console.log('我整合 翻译第1章 完成')
            if (finishStatus.indexOf(0) == -1) {
                console.log('翻译完成')
            }
            console.log(" ==> 宏观任务结束")
        }, 5000)


        new Promise(function (resolve) {
            console.log('第2章：我负责翻译')

            resolve()
        }).then(function () {
            new Promise(function (resolve) {

                console.log("==> 微观任务开始")
                console.log("翻译任务在进行中")
                console.log('我翻译第2章中')
                console.log('我翻译第2章有点烦，我先翻译其它章再回来 ')
                console.log('==> 我翻译第2章其它任务（微任务）放到后面')
                resolve()
            }).then(function () {
                finishStatus[1] = 1
                console.log('我 翻译第2章 完成')
            })
        })


        // b 翻译第3章

        console.log("第3章：B 翻译")
        setTimeout(function () {
            console.log('B 翻译第3章 完成 ==> 宏观任务开始')
            finishStatus[2] = 1
            console.log('我整合 翻译第3章 完成')
            if (finishStatus.indexOf(0) == -1) {
                console.log('翻译完成')
            }
            console.log(" ==> 宏观任务结束")
        }, 3000)


        new Promise(function (resolve) {
            console.log('第4章：我负责翻译')

            resolve()
        }).then(function () {
            new Promise(function (resolve) {
                console.log('我第4章翻译完')
                finishStatus[3] = 1
            })
        })

        // c 翻译第5章

        console.log("第5章：C 翻译")
        setTimeout(function () {
            console.log('C 翻译第5章 完成 ==> 宏观任务开始')
            finishStatus[4] = 1
            console.log('我整合 翻译第5章 完成')
            if (finishStatus.indexOf(0) == -1) {
                console.log('翻译完成')
            }
            console.log(" ==> 宏观任务结束")
        }, 0)

        async function charter6() {
            await Dcharter6start()
            await Dcharter6doing1()
            await Dcharter6doing2()
            await Dcharter6finish()
        }
        charter6()

        async function Dcharter6start() {
            console.log('第6章：我负责翻译')
        }
        async function Dcharter6doing1() {
            console.log('我翻译第6章有点烦，我先翻译其它章再回来')

            console.log('==> 我翻译第6章其它任务（微任务）放到后面')
        }
        async function Dcharter6doing2() {
            console.log('我翻译第6章有点烦，没有其它可以翻译了，我休息一会儿')
            console.log('==> 我翻译第6章其它任务（微任务）放到后面')
        }
        async function Dcharter6finish() {
            console.log('我 翻译第6章 完成')

            finishStatus[5] = 1
            console.log('我负责的所有翻译完成了， 有空处理看看其它人翻译情况了')
            console.log("==> 微观任务结束")
        }


        console.log("任务分析完成 ==> 宏观任务结束")


            ; (function () {
                async function async123() {
                    console.log('async1 start')
                    await async2()
                    console.log('between async2 3')
                    await async3()
                    console.log('async1 end')
                }
                async function async1() {
                    console.log('async1 start')
                    await async2()
                    console.log('between async2 3')
                    await async3()
                    console.log('async1 end')
                }

                function async2() {
                    console.log('async2')
                    return new Promise(function (resolve) {
                        setTimeout(function () {
                            console.log(' 1 seconds passed, async2 time out resovlved')
                            resolve()
                        }, 10000)
                    })
                }

                async function async3() {
                    console.log('async3')
                }

                //


                async function async11() {
                    console.log('async11 start')
                    await async21()
                    console.log('between async21 31')
                    await async31()
                    console.log('async31 end')
                    await async31()
                    console.log('async11 end')
                }

                async function async12() {
                    console.log('async12 start')
                    await async21()
                    console.log('between async21 31')
                    await async31()
                    console.log('async31 end')
                    await async31()
                    console.log('async12 end')
                }

                async function async21() {
                    console.log('async21')
                }

                async function async31() {
                    console.log('async31')
                }

                console.log('script start')
                setTimeout(function () {
                    console.log('settimeout 5 seconds')
                }, 5000)

                setTimeout(function () {
                    console.log('settimeout 10 second')
                }, 15000)

                setTimeout(function () {
                    setTimeout(function () {
                        console.log('settimeout 0.5 second')
                    }, 500)
                    console.log('settimeout')
                })
                new Promise(function (resolve) {
                    console.log('promise1')
                    resolve()
                }).then(function () {
                    new Promise(function (resolve) {
                        console.log('promise2')
                        resolve()
                    }).then(function () {
                        console.log('promise3')
                    })
                })
                new Promise(function (resolve) {
                    console.log('promise1')
                    resolve()
                }).then(function () {
                    new Promise(function (resolve) {
                        console.log('promise2')
                        resolve()
                    }).then(function () {
                        console.log('promise3')
                    })
                })

                async1()
                async12()
                async11()
                console.log('script end')


                setTimeout(function () {
                    console.log('settimeout 5 seconds')
                }, 5000)

                setTimeout(function () {
                    console.log('settimeout 10 second')
                }, 10000)

                setTimeout(function () {
                    setTimeout(function () {
                        console.log('settimeout 1st 2 second')
                        setTimeout(function () {
                            console.log('settimeout 2nd 2 second')
                            setTimeout(function () {
                                console.log('settimeout 3rd 2 second')
                            }, 2000)
                        }, 2000)
                    }, 2000)
                    console.log('settimeout')
                })



                var i = 1
                console.log(i)
                new Promise(function (resolve) {
                    console.log('promise1_1')
                    i = 2
                    console.log(i)
                    resolve()
                }).then(function () {
                    new Promise(function (resolve) {
                        console.log('promise1_2')

                        console.log(i)
                        setTimeout(function () {
                            console.log('settimeout 1 second')
                        }, 1000)
                        resolve()
                    }).then(function () {
                        console.log('promise1_3')
                    })
                })


                console.log('after Promise 1')

                new Promise(function (resolve) {
                    console.log('promise2_1')
                    i = 3
                    console.log(i)
                    resolve()
                }).then(function () {
                    new Promise(function (resolve) {
                        console.log('promise2_2')
                        console.log(i)
                        setTimeout(function () {
                            console.log('settimeout 3 second')
                        }, 3000)
                        resolve()
                    }).then(function () {
                        console.log('promise2_3')
                    })
                })
                console.log('after Promise 2')




                new Promise(function (resolve) {
                    console.log('promise3_1')
                    resolve()
                }).then(function () {
                    new Promise(function (resolve) {
                        console.log('promise3_2')
                        setTimeout(function () {
                            console.log('settimeout 3 second')
                            resolve()
                        }, 15000)
                    }).then(function () {
                        console.log('promise3_3')
                    })
                })
                console.log('after Promise 3')



                setTimeout(() => {
                    console.log('timer1')
                    Promise.resolve().then(function () {
                        console.log('promise1')
                    }).then(function () {
                        console.log('promise11')
                    })
                }, 0)
                setTimeout(() => {
                    console.log('timer2')
                    Promise.resolve().then(function () {
                        console.log('promise2')
                    }).then(function () {
                        console.log('promise22')
                    })
                }, 0)
                // for (var i = 0; i < 5; i++) {
                //     setTimeout(function () {
                //         console.log(i);
                //         debugger
                //     }, 1000 * i);
                // }

                // debugger


                debugger
            })



    </script>


</head>

<body>

</body>

</html>